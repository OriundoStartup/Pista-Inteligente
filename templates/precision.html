{% extends "base.html" %}

{% block title %}Precisi√≥n del Modelo IA - Transparencia Total | Pista Inteligente{% endblock %}

{% block meta_description %}
<meta name="description"
    content="Transparencia total: Descubre la precisi√≥n real de nuestras predicciones IA para Hip√≥dromo Chile y Club H√≠pico. M√©tricas verificables comparando pron√≥sticos vs resultados reales.">
{% endblock %}

{% block content %}
<!-- Hero Section -->
<div style="text-align: center; margin-bottom: 3rem;">
    <h1 style="font-size: 2.5rem; color: var(--text-main); margin-bottom: 0.5rem; font-weight: 800;">
        üìä Transparencia Total: Nuestra Precisi√≥n Real
    </h1>
    <p style="color: var(--text-muted); font-size: 1.2rem; max-width: 900px; margin: 0 auto;">
        A diferencia de los sitios tradicionales que ocultan sus resultados, <strong>mostramos con orgullo</strong> la
        precisi√≥n de nuestro modelo de IA
        comparando nuestras predicciones con los resultados reales de cada carrera.
    </p>
</div>

<!-- M√©tricas Principales -->
<div class="glass-card" style="margin-bottom: 2rem;">
    <div class="section-title">üéØ Precisi√≥n del Modelo - √öltimos 30 D√≠as</div>

    {% if metricas_30d.get('total_carreras', 0) > 0 %}
    <div
        style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
        <!-- Top 1 Accuracy -->
        <div class="glass-card" style="text-align: center; padding: 2rem; border-left: 4px solid #FFD700;">
            <div style="font-size: 1rem; color: var(--text-muted); margin-bottom: 0.5rem;">ü•á GANADOR EXACTO</div>
            <div style="font-size: 3.5rem; font-weight: 800; color: #FFD700; margin-bottom: 0.5rem;">
                {{ metricas_30d.top1_accuracy }}%
            </div>
            <div style="color: var(--text-muted); font-size: 0.9rem;">
                {{ metricas_30d.top1_correct }} de {{ metricas_30d.top1_total }} predicciones
            </div>
            <div style="margin-top: 1rem; font-size: 0.85rem; color: var(--text-muted);">
                Nuestro caballo #1 gan√≥ la carrera
            </div>
        </div>

        <!-- Top 3 Accuracy -->
        <div class="glass-card" style="text-align: center; padding: 2rem; border-left: 4px solid #C0C0C0;">
            <div style="font-size: 1rem; color: var(--text-muted); margin-bottom: 0.5rem;">ü•à TOP 3 EXACTO</div>
            <div style="font-size: 3.5rem; font-weight: 800; color: #C0C0C0; margin-bottom: 0.5rem;">
                {{ metricas_30d.top3_accuracy }}%
            </div>
            <div style="color: var(--text-muted); font-size: 0.9rem;">
                {{ metricas_30d.top3_correct }} de {{ metricas_30d.top3_total }} predicciones
            </div>
            <div style="margin-top: 1rem; font-size: 0.85rem; color: var(--text-muted);">
                Caballos predichos en top 3 terminaron en top 3
            </div>
        </div>

        <!-- Top 4 Accuracy -->
        <div class="glass-card" style="text-align: center; padding: 2rem; border-left: 4px solid #CD7F32;">
            <div style="font-size: 1rem; color: var(--text-muted); margin-bottom: 0.5rem;">ü•â TOP 4 EXACTO</div>
            <div style="font-size: 3.5rem; font-weight: 800; color: #CD7F32; margin-bottom: 0.5rem;">
                {{ metricas_30d.top4_accuracy }}%
            </div>
            <div style="color: var(--text-muted); font-size: 0.9rem;">
                {{ metricas_30d.top4_correct }} de {{ metricas_30d.top4_total }} predicciones
            </div>
            <div style="margin-top: 1rem; font-size: 0.85rem; color: var(--text-muted);">
                Caballos predichos en top 4 terminaron en top 4
            </div>
        </div>
    </div>

    <!-- Informaci√≥n del per√≠odo -->
    <div style="text-align: center; padding: 1rem; background: rgba(255,255,255,0.05); border-radius: 8px;">
        <p style="margin: 0; color: var(--text-muted);">
            üìä <strong>{{ metricas_30d.total_carreras }} carreras</strong> analizadas |
            üìÖ Per√≠odo: <strong>{{ metricas_30d.rango_fechas }}</strong>
        </p>
    </div>
    {% else %}
    <div style="text-align: center; padding: 3rem;">
        <p style="color: var(--text-muted); font-size: 1.1rem;">
            üìä A√∫n no hay suficientes datos para mostrar precisi√≥n de los √∫ltimos 30 d√≠as.
            <br>Las m√©tricas se actualizar√°n a medida que procesemos m√°s resultados.
        </p>
    </div>
    {% endif %}
</div>

<!-- Comparaci√≥n de Per√≠odos -->
<div class="glass-card" style="margin-bottom: 2rem;">
    <div class="section-title">üìà Evoluci√≥n de la Precisi√≥n</div>

    <table class="modern-table">
        <thead>
            <tr>
                <th>Per√≠odo</th>
                <th>Ganador Exacto</th>
                <th>Top 3</th>
                <th>Top 4</th>
                <th>Carreras Analizadas</th>
            </tr>
        </thead>
        <tbody>
            {% if metricas_30d.get('total_carreras', 0) > 0 %}
            <tr>
                <td><strong>√öltimos 30 d√≠as</strong></td>
                <td style="color: #FFD700; font-weight: 700;">{{ metricas_30d.top1_accuracy }}%</td>
                <td style="color: #C0C0C0; font-weight: 700;">{{ metricas_30d.top3_accuracy }}%</td>
                <td style="color: #CD7F32; font-weight: 700;">{{ metricas_30d.top4_accuracy }}%</td>
                <td>{{ metricas_30d.total_carreras }}</td>
            </tr>
            {% endif %}

            {% if metricas_90d.get('total_carreras', 0) > 0 %}
            <tr>
                <td><strong>√öltimos 90 d√≠as</strong></td>
                <td style="color: #FFD700; font-weight: 700;">{{ metricas_90d.top1_accuracy }}%</td>
                <td style="color: #C0C0C0; font-weight: 700;">{{ metricas_90d.top3_accuracy }}%</td>
                <td style="color: #CD7F32; font-weight: 700;">{{ metricas_90d.top4_accuracy }}%</td>
                <td>{{ metricas_90d.total_carreras }}</td>
            </tr>
            {% endif %}

            {% if metricas_all.get('total_carreras', 0) > 0 %}
            <tr style="background: rgba(255,255,255,0.05);">
                <td><strong>üìä Hist√≥rico Completo</strong></td>
                <td style="color: #FFD700; font-weight: 800;">{{ metricas_all.top1_accuracy }}%</td>
                <td style="color: #C0C0C0; font-weight: 800;">{{ metricas_all.top3_accuracy }}%</td>
                <td style="color: #CD7F32; font-weight: 800;">{{ metricas_all.top4_accuracy }}%</td>
                <td><strong>{{ metricas_all.total_carreras }}</strong></td>
            </tr>
            {% endif %}
        </tbody>
    </table>
</div>

<!-- Secci√≥n de Transparencia -->
<div class="glass-card" style="margin-bottom: 2rem;">
    <div class="section-title">üîç Nuestro Compromiso con la Transparencia</div>

    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1.5rem;">
        <div
            style="padding: 1.5rem; background: rgba(52, 211, 153, 0.1); border-radius: 12px; border-left: 4px solid var(--secondary);">
            <div style="font-size: 2rem; margin-bottom: 0.5rem;">‚úÖ</div>
            <h3 style="color: var(--secondary); margin-bottom: 0.5rem;">100% Verificable</h3>
            <p style="color: var(--text-muted); margin: 0;">
                Cada predicci√≥n queda registrada en nuestra base de datos antes de la carrera,
                y la comparamos autom√°ticamente con el resultado real.
            </p>
        </div>

        <div
            style="padding: 1.5rem; background: rgba(99, 102, 241, 0.1); border-radius: 12px; border-left: 4px solid var(--primary);">
            <div style="font-size: 2rem; margin-bottom: 0.5rem;">üìä</div>
            <h3 style="color: var(--primary); margin-bottom: 0.5rem;">Datos Reales</h3>
            <p style="color: var(--text-muted); margin: 0;">
                No manipulamos cifras. Mostramos la precisi√≥n calculada directamente
                desde resultados oficiales de Hip√≥dromo Chile y Club H√≠pico.
            </p>
        </div>

        <div
            style="padding: 1.5rem; background: rgba(251, 191, 36, 0.1); border-radius: 12px; border-left: 4px solid var(--accent);">
            <div style="font-size: 2rem; margin-bottom: 0.5rem;">üéØ</div>
            <h3 style="color: var(--accent); margin-bottom: 0.5rem;">Mejora Continua</h3>
            <p style="color: var(--text-muted); margin: 0;">
                Nuestro modelo de IA aprende de cada carrera. Actualizamos y mejoramos
                constantemente nuestros algoritmos bas√°ndonos en estos resultados.
            </p>
        </div>
    </div>
</div>

<!-- √öltimas Predicciones (Transparencia en vivo) -->
<div class="glass-card" style="margin-bottom: 2rem;">
    <div class="section-title">üîÆ √öltimas Predicciones Generadas</div>
    <p style="text-align: center; color: var(--text-muted); margin-bottom: 1.5rem;">
        Estas son las predicciones m√°s recientes generadas por nuestro sistema. Quedan registradas 
        p√∫blicamente antes de cada carrera.
    </p>
    
    <div style="overflow-x: auto;">
        <table class="modern-table">
            <thead>
                <tr>
                    <th>Fecha Carrera</th>
                    <th>Hip√≥dromo</th>
                    <th>Carrera</th>
                    <th>N¬∫</th>
                    <th>Caballo</th>
                    <th>Ranking IA</th>
                    <th>Score IA</th>
                </tr>
            </thead>
            <tbody>
                {% for p in predicciones_recientes %}
                <tr>
                    <td>{{ p.fecha_carrera }}</td>
                    <td>{{ p.hipodromo }}</td>
                    <td style="text-align: center; font-weight: bold;">{{ p.nro_carrera }}</td>
                    <td style="text-align: center;">{{ p.numero_caballo }}</td>
                    <td>{{ p.caballo }}</td>
                    <td style="text-align: center;">
                        {% if p.ranking_prediccion == 1 %}ü•á{% endif %}
                        {% if p.ranking_prediccion == 2 %}ü•à{% endif %}
                        {% if p.ranking_prediccion == 3 %}ü•â{% endif %}
                        {{ p.ranking_prediccion }}
                    </td>
                    <td style="text-align: center; font-weight: bold; color: var(--primary);">{{ p.puntaje_ia }}</td>
                </tr>
                {% else %}
                <tr>
                    <td colspan="7" style="text-align: center; padding: 2rem; color: var(--text-muted);">
                        No hay predicciones recientes registradas a√∫n.
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<!-- Metodolog√≠a -->
<div class="glass-card">
    <div class="section-title">üß™ Metodolog√≠a de C√°lculo</div>

    <div style="background: rgba(255,255,255,0.05); padding: 2rem; border-radius: 12px;">
        <h3 style="color: var(--secondary); margin-top: 0;">¬øC√≥mo calculamos la precisi√≥n?</h3>

        <div style="margin: 1.5rem 0;">
            <h4 style="color: #FFD700; margin-bottom: 0.5rem;">ü•á Ganador Exacto (Top 1)</h4>
            <p style="color: var(--text-muted); margin: 0;">
                Porcentaje de veces que nuestro caballo predicho como #1 gan√≥ la carrera.
                Esta es la m√©trica m√°s exigente y demuestra nuestra capacidad de identificar al ganador exacto.
            </p>
        </div>

        <div style="margin: 1.5rem 0;">
            <h4 style="color: #C0C0C0; margin-bottom: 0.5rem;">ü•à Top 3 Exacto</h4>
            <p style="color: var(--text-muted); margin: 0;">
                Porcentaje de caballos que predijimos en top 3 y efectivamente terminaron en top 3.
                √ötil para estrategias de apuesta como Trifecta y Superfecta.
            </p>
        </div>

        <div style="margin: 1.5rem 0;">
            <h4 style="color: #CD7F32; margin-bottom: 0.5rem;">ü•â Top 4 Exacto</h4>
            <p style="color: var(--text-muted); margin: 0;">
                Porcentaje de caballos que predijimos en top 4 y terminaron en top 4.
                Representa el rendimiento general de nuestro sistema de scoring.
            </p>
        </div>

        <div
            style="margin-top: 2rem; padding: 1rem; background: rgba(59, 130, 246, 0.1); border-left: 4px solid var(--primary); border-radius: 8px;">
            <p style="margin: 0; color: var(--text-main);">
                <strong>üí° Nota Importante:</strong> Estas m√©tricas se calculan solo con carreras completadas donde
                tenemos tanto la predicci√≥n previa como el resultado oficial. Los valores se actualizan autom√°ticamente
                cada vez que se procesan nuevos resultados.
            </p>
        </div>
    </div>
</div>

<!-- Call to Action -->
<div
    style="text-align: center; margin-top: 3rem; padding: 3rem 1rem; background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(52, 211, 153, 0.1)); border-radius: 16px;">
    <h2 style="color: var(--text-main); margin-bottom: 1rem; font-size: 2rem;">
        ¬øListo para aprovechar nuestras predicciones?
    </h2>
    <p
        style="color: var(--text-muted); font-size: 1.1rem; margin-bottom: 2rem; max-width: 600px; margin-left: auto; margin-right: auto;">
        Descubre los pron√≥sticos de IA para las pr√≥ximas carreras de Hip√≥dromo Chile y Club H√≠pico
    </p>
    <a href="/programa" class="cta-button" style="display: inline-block;">
        Ver Predicciones de Hoy
    </a>
</div>

{% endblock %}